<!DOCTYPE html>
{% load staticfiles %}

<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6 lte-ie8"> <![endif]-->
<!--[if IE 7 ]> <html lang="en" class="no-js ie7 lte-ie8"> <![endif]-->
<!--[if IE 8 ]> <html lang="en" class="no-js ie8 lte-ie8"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> <html lang="en" class=" js cssanimations"> <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
		<meta name="viewport" content="width=device-width, initial-scale=1" /> 
		<title>
			{% block title %}Patient Tracker{% endblock %}
		</title>
		<link rel="stylesheet" type="text/css" href="{% static 'scripts/bootstrap/css/bootstrap.min.css' %}">
		<link rel="stylesheet" type="text/css" href="{% static 'scripts/bootstrap/css/bootstrap-theme.min.css' %}">
		<link rel="stylesheet" type="text/css" href="{% static 'scripts/custom.css' %}"
	</head>
	
	<body>
		<div class="panel-group" id="accordion">
			{% for patient, last_step, current_step, formset in patient_list %}
			<div class="panel panel-default">
				<div class="panel-heading">
					<h4 class="panel-title">
						<a data-toggle="collapse" data-parent="#accordion" href="#collapse{{ forloop.counter }}" class="collapsed" id="name">
							{{ patient.name|upper }}
						</a>
						<a data-toggle="collapse" data-parent="#accordion" href="#collapse{{ forloop.counter }}" class="collapsed" id="DOB">
							{{ patient.dob|date:"M d Y" }}
						</a>
						<a data-toggle="collapse" data-parent="#accordion" href="#collapse{{ forloop.counter }}" class="collapsed" id="last">
							{% if last_step == "None" %}
								{{ last_step }}
							{% else %}
								{{ last_step.step }}
							{% endif %}
						</a>
						<a data-toggle="collapse" data-parent="#accordion" href="#collapse{{ forloop.counter }}" class="collapsed" id="status">
							{{ current_step.step }}
						</a>
						<a data-toggle="collapse" data-parent="#accordion" href="#collapse{{ forloop.counter }}" class="collapsed" id="flag">
							{{ patient.flag }}
						</a>

					</h4>
				</div>
				<div id="collapse{{ forloop.counter }}" class="panel-collapse collapse" style="height: 0px;">
					<div class="panel-body">
						
						<form method="post" action="">
						{% csrf_token %}
						{{ formset.management_form }}
						<ul>
							{% for form in formset %}
							{{ form }}
							{% empty %}
								<ul> No data to enter. </ul>
							{% endfor %}
						</ul>
						<input type = "submit" name = "Patient Outcome-{{patient.pk}}" value = "Submit" />
						</form>
					</div>
				</div>
			</div>
			{% empty %}
				<label> No patients as of now. </label> <!--Asher make this look pretty <3-->
			{% endfor %}
		</div>

		
		{% if AddPatientform.errors %}
    			{% for field in AddPatientform %}
        			{% for error in field.errors %}
            				<div class="alert alert-error">
                				<strong>{{ error|escape }}</strong>
            				</div>
        			{% endfor %}
    			{% endfor %}
    			{% for error in AddPatientform.non_field_errors %}
        			<div class="alert alert-error">
            			<strong>{{ error|escape }}</strong>
        			</div>
    			{% endfor %}
		{% endif %}


		<form method="post" action="">
		{% csrf_token %}
		{% for field in AddPatientform %}
			<tr><th> {{ field.label_tag }} {{ field }} </td></tr>
		{% endfor %}
		
		<input type="submit" name="Add Patient" value="Add Patient" />
		</form>

	
		

	
	</body>
	
	<footer>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
		<script src="{% static 'scripts/bootstrap/js/bootstrap.js' %}"></script>
	</footer>

</html>
